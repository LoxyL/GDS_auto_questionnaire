# 学生问卷分析与报告生成系统

这个系统可以自动分析学生填写的问卷，并利用GPT-4o生成个性化的学习分析报告。系统会生成两种报告：一种是面向学生的报告，一种是内部使用的详细分析报告。

## 功能特点

- 自动处理问卷数据（CSV或Excel格式）
- 使用GPT-4o分析学生情况
- 推断学生的MBTI性格类型
- 评估学生的学习状况和潜在问题
- 分析购买教育产品的意愿
- 评估家庭支持和经济状况
- 生成个性化学习建议
- 创建两种不同的报告（学生版和内部版）

## 环境要求

- Python 3.6+
- OpenAI API密钥

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

1. 将学生问卷数据（CSV或Excel格式）放入`input`文件夹中
2. 设置OpenAI API密钥（两种方式）：
   - 方式一：创建`.env`文件并添加以下内容：
     ```
     OPENAI_API_KEY=your_api_key_here
     MODEL=gpt-4o  # 可选，默认为gpt-4o
     ```
   - 方式二：通过环境变量设置
     ```bash
     export OPENAI_API_KEY='your-api-key'
     ```
3. 运行主程序
   ```bash
   python main.py
   ```
4. 生成的报告将保存在以下位置：
   - 学生报告：`output/student_reports/`
   - 内部报告：`output/internal_reports/`
   - 原始分析数据：`output/`

## 问卷格式

问卷可以是CSV或Excel格式，包含问题和答案。可以使用两种格式：

1. 表头为问题，一行数据为答案
2. 两列格式：第一列为问题，第二列为回答

示例文件`input/example_questionnaire.csv`和`input/detailed_questionnaire.csv`提供了参考格式。

## 输出示例

### 学生报告

学生报告包括：
- 性格分析
- 学习情况评估
- 存在的学习问题
- 学习态度与习惯分析
- 个性化学习建议
- 推荐产品

### 内部报告

内部报告包括：
- 详细的性格分析
- 购买意愿评估
- 学习状况详细分析
- 家庭和经济情况
- 产品推荐和理由
- 跟进建议

## 注意事项

- 程序会自动处理`input`文件夹中最新的问卷文件
- 确保问卷数据尽可能完整，以便获得更准确的分析
- API调用可能产生费用，请注意控制使用频率
- 分析结果仅供参考，不应替代专业教育顾问的建议 